<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Updating: A Set of Bayesian Notes</title>
  <meta name="description" content="Updating: A Set of Bayesian Notes">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Updating: A Set of Bayesian Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://jrnold.github.io/bayesian_notes" />
  
  
  <meta name="github-repo" content="jrnold/bayesian_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Updating: A Set of Bayesian Notes" />
  <meta name="twitter:site" content="@jrnld" />
  
  

<meta name="author" content="Jeffrey B. Arnold">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="binomial-models.html">
<link rel="next" href="robust-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.0/DiagrammeR.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>



<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Bayesian Notes</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Bayesian Inference</a><ul>
<li class="chapter" data-level="1.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayesian-analysis"><i class="fa fa-check"></i><b>1.1</b> Bayesian Analysis</a></li>
<li class="chapter" data-level="1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>1.2</b> Posterior Predictive Distribution</a></li>
</ul></li>
<li class="part"><span><b>I Theory</b></span></li>
<li class="chapter" data-level="2" data-path="bayes-theorem.html"><a href="bayes-theorem.html"><i class="fa fa-check"></i><b>2</b> Bayes Theorem</a><ul>
<li class="chapter" data-level="" data-path="bayes-theorem.html"><a href="bayes-theorem.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#introduction-to-bayes-theorem"><i class="fa fa-check"></i><b>2.1</b> Introduction to Bayes’ Theorem</a></li>
<li class="chapter" data-level="2.2" data-path="bayes-theorem.html"><a href="bayes-theorem.html#examples"><i class="fa fa-check"></i><b>2.2</b> Examples</a><ul>
<li class="chapter" data-level="2.2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#taxi-cab-problem"><i class="fa fa-check"></i><b>2.2.1</b> Taxi-Cab Problem</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bayes-theorem.html"><a href="bayes-theorem.html#why-most-research-findings-are-false"><i class="fa fa-check"></i><b>2.3</b> Why most research findings are false</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#questions"><i class="fa fa-check"></i><b>2.3.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bayes-theorem.html"><a href="bayes-theorem.html#measurement-error-and-rare-events-in-surveys"><i class="fa fa-check"></i><b>2.4</b> Measurement Error and Rare Events in Surveys</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html"><i class="fa fa-check"></i><b>3</b> Example: Predicting Names from Ages</a><ul>
<li class="chapter" data-level="" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#statement-of-the-problem"><i class="fa fa-check"></i><b>3.1</b> Statement of the problem</a></li>
<li class="chapter" data-level="3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#data-wrangling"><i class="fa fa-check"></i><b>3.2</b> Data Wrangling</a></li>
<li class="chapter" data-level="3.3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#probability-of-age-given-name-and-sex"><i class="fa fa-check"></i><b>3.3</b> Probability of age given name and sex</a><ul>
<li class="chapter" data-level="3.3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#questions-1"><i class="fa fa-check"></i><b>3.3.1</b> Questions</a></li>
<li class="chapter" data-level="3.3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#references"><i class="fa fa-check"></i><b>3.3.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i><b>4</b> Naive Bayes</a><ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="naive-bayes.html"><a href="naive-bayes.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="naive-bayes.html"><a href="naive-bayes.html#examples-1"><i class="fa fa-check"></i><b>4.2</b> Examples</a><ul>
<li class="chapter" data-level="4.2.1" data-path="naive-bayes.html"><a href="naive-bayes.html#federalist-papers"><i class="fa fa-check"></i><b>4.2.1</b> Federalist Papers</a></li>
<li class="chapter" data-level="4.2.2" data-path="naive-bayes.html"><a href="naive-bayes.html#extensions"><i class="fa fa-check"></i><b>4.2.2</b> Extensions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="naive-bayes.html"><a href="naive-bayes.html#details"><i class="fa fa-check"></i><b>4.3</b> Details</a><ul>
<li class="chapter" data-level="4.3.1" data-path="naive-bayes.html"><a href="naive-bayes.html#generative-vs.discriminative-models"><i class="fa fa-check"></i><b>4.3.1</b> Generative vs. Discriminative Models</a></li>
<li class="chapter" data-level="4.3.2" data-path="naive-bayes.html"><a href="naive-bayes.html#estimation"><i class="fa fa-check"></i><b>4.3.2</b> Estimation</a></li>
<li class="chapter" data-level="4.3.3" data-path="naive-bayes.html"><a href="naive-bayes.html#prediction"><i class="fa fa-check"></i><b>4.3.3</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="naive-bayes.html"><a href="naive-bayes.html#references-1"><i class="fa fa-check"></i><b>4.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>5</b> Priors</a><ul>
<li class="chapter" data-level="5.1" data-path="priors.html"><a href="priors.html#levels-of-priors"><i class="fa fa-check"></i><b>5.1</b> Levels of Priors</a></li>
<li class="chapter" data-level="5.2" data-path="priors.html"><a href="priors.html#conjugate-priors"><i class="fa fa-check"></i><b>5.2</b> Conjugate Priors</a><ul>
<li class="chapter" data-level="5.2.1" data-path="priors.html"><a href="priors.html#binomial-beta"><i class="fa fa-check"></i><b>5.2.1</b> Binomial-Beta</a></li>
<li class="chapter" data-level="5.2.2" data-path="priors.html"><a href="priors.html#categorical-dirichlet"><i class="fa fa-check"></i><b>5.2.2</b> Categorical-Dirichlet</a></li>
<li class="chapter" data-level="5.2.3" data-path="priors.html"><a href="priors.html#poisson-gamma"><i class="fa fa-check"></i><b>5.2.3</b> Poisson-Gamma</a></li>
<li class="chapter" data-level="5.2.4" data-path="priors.html"><a href="priors.html#normal-with-known-variance"><i class="fa fa-check"></i><b>5.2.4</b> Normal with known variance</a></li>
<li class="chapter" data-level="5.2.5" data-path="priors.html"><a href="priors.html#exponential-family"><i class="fa fa-check"></i><b>5.2.5</b> Exponential Family</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="priors.html"><a href="priors.html#improper-priors"><i class="fa fa-check"></i><b>5.3</b> Improper Priors</a></li>
<li class="chapter" data-level="5.4" data-path="priors.html"><a href="priors.html#cromwells-rule"><i class="fa fa-check"></i><b>5.4</b> Cromwell’s Rule</a></li>
<li class="chapter" data-level="5.5" data-path="priors.html"><a href="priors.html#asymptotics"><i class="fa fa-check"></i><b>5.5</b> Asymptotics</a></li>
<li class="chapter" data-level="5.6" data-path="priors.html"><a href="priors.html#proper-and-improper-priors"><i class="fa fa-check"></i><b>5.6</b> Proper and Improper Priors</a></li>
<li class="chapter" data-level="5.7" data-path="priors.html"><a href="priors.html#hyperpriors-and-hyperparameters"><i class="fa fa-check"></i><b>5.7</b> Hyperpriors and Hyperparameters</a></li>
<li class="chapter" data-level="5.8" data-path="priors.html"><a href="priors.html#references-2"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-1.html"><a href="estimation-1.html"><i class="fa fa-check"></i><b>6</b> Estimation</a><ul>
<li class="chapter" data-level="6.1" data-path="estimation-1.html"><a href="estimation-1.html#point-estimates"><i class="fa fa-check"></i><b>6.1</b> Point Estimates</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-1.html"><a href="estimation-1.html#credible-intervals"><i class="fa fa-check"></i><b>6.2</b> Credible Intervals</a><ul>
<li class="chapter" data-level="6.2.1" data-path="estimation-1.html"><a href="estimation-1.html#compared-to-confidence-intervals"><i class="fa fa-check"></i><b>6.2.1</b> Compared to confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="estimation-1.html"><a href="estimation-1.html#bayesian-decision-theory"><i class="fa fa-check"></i><b>6.3</b> Bayesian Decision Theory</a></li>
</ul></li>
<li class="part"><span><b>II Computation</b></span></li>
<li class="chapter" data-level="7" data-path="bayesian-computation.html"><a href="bayesian-computation.html"><i class="fa fa-check"></i><b>7</b> Bayesian Computation</a><ul>
<li class="chapter" data-level="7.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#how-to-calculate-a-posterior"><i class="fa fa-check"></i><b>7.1</b> How to calculate a posterior?</a></li>
<li class="chapter" data-level="7.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#example-globe-tossing-model"><i class="fa fa-check"></i><b>7.2</b> Example: Globe-tossing model</a></li>
<li class="chapter" data-level="7.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#quadrature"><i class="fa fa-check"></i><b>7.3</b> Quadrature</a><ul>
<li class="chapter" data-level="7.3.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#grid-approximation"><i class="fa fa-check"></i><b>7.3.1</b> Grid approximation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#functional-approximations"><i class="fa fa-check"></i><b>7.4</b> Functional Approximations</a><ul>
<li class="chapter" data-level="7.4.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#maximum-a-posteriori"><i class="fa fa-check"></i><b>7.4.1</b> Maximum A Posteriori</a></li>
<li class="chapter" data-level="7.4.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#laplace-approximation"><i class="fa fa-check"></i><b>7.4.2</b> Laplace Approximation</a></li>
<li class="chapter" data-level="7.4.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#variational-inference"><i class="fa fa-check"></i><b>7.4.3</b> Variational Inference</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#sampling-methods"><i class="fa fa-check"></i><b>7.5</b> Sampling Methods</a><ul>
<li class="chapter" data-level="7.5.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#numerical-integration"><i class="fa fa-check"></i><b>7.5.1</b> Numerical Integration</a></li>
<li class="chapter" data-level="7.5.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#inverse-transform-sampling"><i class="fa fa-check"></i><b>7.5.2</b> Inverse transform sampling</a></li>
<li class="chapter" data-level="7.5.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#direct-approximation"><i class="fa fa-check"></i><b>7.5.3</b> Direct approximation</a></li>
<li class="chapter" data-level="7.5.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#rejection-sampling"><i class="fa fa-check"></i><b>7.5.4</b> Rejection sampling</a></li>
<li class="chapter" data-level="7.5.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#importance-sampling"><i class="fa fa-check"></i><b>7.5.5</b> Importance Sampling</a></li>
<li class="chapter" data-level="7.5.6" data-path="bayesian-computation.html"><a href="bayesian-computation.html#mcmc-methods"><i class="fa fa-check"></i><b>7.5.6</b> MCMC Methods</a></li>
<li class="chapter" data-level="7.5.7" data-path="bayesian-computation.html"><a href="bayesian-computation.html#discarding-early-iterations"><i class="fa fa-check"></i><b>7.5.7</b> Discarding early iterations</a></li>
<li class="chapter" data-level="7.5.8" data-path="bayesian-computation.html"><a href="bayesian-computation.html#monte-carlo-sampling"><i class="fa fa-check"></i><b>7.5.8</b> Monte Carlo Sampling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html"><i class="fa fa-check"></i><b>8</b> MCMC Diagnostics</a><ul>
<li class="chapter" data-level="" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#reparameterize-models"><i class="fa fa-check"></i><b>8.1</b> Reparameterize Models</a></li>
<li class="chapter" data-level="8.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#convergence-diagnostics"><i class="fa fa-check"></i><b>8.2</b> Convergence Diagnostics</a><ul>
<li class="chapter" data-level="8.2.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#potential-scale-reduction-hatr"><i class="fa fa-check"></i><b>8.2.1</b> Potential Scale Reduction (<span class="math inline">\(\hat{R}\)</span>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#references-3"><i class="fa fa-check"></i><b>8.2.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#autocorrelation-effective-sample-size-and-mcse"><i class="fa fa-check"></i><b>8.3</b> Autocorrelation, Effective Sample Size, and MCSE</a><ul>
<li class="chapter" data-level="8.3.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#effective-sample-size"><i class="fa fa-check"></i><b>8.3.1</b> Effective Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#thinning"><i class="fa fa-check"></i><b>8.4</b> Thinning</a><ul>
<li class="chapter" data-level="8.4.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#traceplots"><i class="fa fa-check"></i><b>8.4.1</b> Traceplots</a></li>
<li class="chapter" data-level="8.4.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#monte-carlo-standard-error-mcse"><i class="fa fa-check"></i><b>8.4.2</b> Monte Carlo Standard Error (MCSE)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#hmc-nut-specific-diagnostics"><i class="fa fa-check"></i><b>8.5</b> HMC-NUT Specific Diagnostics</a><ul>
<li class="chapter" data-level="8.5.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#divergent-transitions"><i class="fa fa-check"></i><b>8.5.1</b> Divergent transitions</a></li>
<li class="chapter" data-level="8.5.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#maximum-tree-depth"><i class="fa fa-check"></i><b>8.5.2</b> Maximum Tree-depth</a></li>
<li class="chapter" data-level="8.5.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#bayesian-fraction-of-missing-information"><i class="fa fa-check"></i><b>8.5.3</b> Bayesian Fraction of Missing Information</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#debugging-bayesian-computing"><i class="fa fa-check"></i><b>8.6</b> Debugging Bayesian Computing</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>9</b> Model Checking</a><ul>
<li class="chapter" data-level="9.1" data-path="model-checking.html"><a href="model-checking.html#why-check-models"><i class="fa fa-check"></i><b>9.1</b> Why check models?</a></li>
<li class="chapter" data-level="9.2" data-path="model-checking.html"><a href="model-checking.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2</b> Posterior Predictive Checks</a><ul>
<li class="chapter" data-level="9.2.1" data-path="model-checking.html"><a href="model-checking.html#bayesian-p-values"><i class="fa fa-check"></i><b>9.2.1</b> Bayesian p-values</a></li>
<li class="chapter" data-level="9.2.2" data-path="model-checking.html"><a href="model-checking.html#test-quantities"><i class="fa fa-check"></i><b>9.2.2</b> Test quantities</a></li>
<li class="chapter" data-level="9.2.3" data-path="model-checking.html"><a href="model-checking.html#p-values-vs.u-values"><i class="fa fa-check"></i><b>9.2.3</b> p-values vs. u-values</a></li>
<li class="chapter" data-level="9.2.4" data-path="model-checking.html"><a href="model-checking.html#marginal-predictive-checks"><i class="fa fa-check"></i><b>9.2.4</b> Marginal predictive checks</a></li>
<li class="chapter" data-level="9.2.5" data-path="model-checking.html"><a href="model-checking.html#outliers"><i class="fa fa-check"></i><b>9.2.5</b> Outliers</a></li>
<li class="chapter" data-level="9.2.6" data-path="model-checking.html"><a href="model-checking.html#graphical-posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2.6</b> Graphical Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="model-checking.html"><a href="model-checking.html#references-4"><i class="fa fa-check"></i><b>9.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10</b> Model Comparison</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison.html"><a href="model-comparison.html#continuous-model-expansion"><i class="fa fa-check"></i><b>10.1</b> Continuous model expansion</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison.html"><a href="model-comparison.html#posterior-predictive-criteria"><i class="fa fa-check"></i><b>10.2</b> Posterior Predictive Criteria</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison.html"><a href="model-comparison.html#summary-and-advice"><i class="fa fa-check"></i><b>10.2.1</b> Summary and Advice</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison.html"><a href="model-comparison.html#expected-log-predictive-density"><i class="fa fa-check"></i><b>10.2.2</b> Expected Log Predictive Density</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Models</b></span></li>
<li class="chapter" data-level="11" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Introduction to Stan and Linear Regression</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="11.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#ols-and-mle-linear-regression"><i class="fa fa-check"></i><b>11.1</b> OLS and MLE Linear Regression</a><ul>
<li class="chapter" data-level="11.1.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#bayesian-model-with-improper-priors"><i class="fa fa-check"></i><b>11.1.1</b> Bayesian Model with Improper priors</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#stan-model"><i class="fa fa-check"></i><b>11.2</b> Stan Model</a></li>
<li class="chapter" data-level="11.3" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling-model-with-stan"><i class="fa fa-check"></i><b>11.3</b> Sampling Model with Stan</a><ul>
<li class="chapter" data-level="11.3.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling"><i class="fa fa-check"></i><b>11.3.1</b> Sampling</a></li>
<li class="chapter" data-level="11.3.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#convergence-diagnostics-and-model-fit"><i class="fa fa-check"></i><b>11.3.2</b> Convergence Diagnostics and Model Fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>12</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="12.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#introduction-1"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#count-models"><i class="fa fa-check"></i><b>12.2</b> Count Models</a><ul>
<li class="chapter" data-level="12.2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson"><i class="fa fa-check"></i><b>12.2.1</b> Poisson</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#example-3"><i class="fa fa-check"></i><b>12.3</b> Example</a></li>
<li class="chapter" data-level="12.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial"><i class="fa fa-check"></i><b>12.4</b> Negative Binomial</a></li>
<li class="chapter" data-level="12.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#multinomial-categorical-models"><i class="fa fa-check"></i><b>12.5</b> Multinomial / Categorical Models</a></li>
<li class="chapter" data-level="12.6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#gamma-regression"><i class="fa fa-check"></i><b>12.6</b> Gamma Regression</a></li>
<li class="chapter" data-level="12.7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#beta-regression"><i class="fa fa-check"></i><b>12.7</b> Beta Regression</a></li>
<li class="chapter" data-level="12.8" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#references-5"><i class="fa fa-check"></i><b>12.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="binomial-models.html"><a href="binomial-models.html"><i class="fa fa-check"></i><b>13</b> Binomial Models</a><ul>
<li class="chapter" data-level="" data-path="binomial-models.html"><a href="binomial-models.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="13.1" data-path="binomial-models.html"><a href="binomial-models.html#introduction-2"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="binomial-models.html"><a href="binomial-models.html#link-functions-link-function"><i class="fa fa-check"></i><b>13.2</b> Link Functions {link-function}</a><ul>
<li class="chapter" data-level="13.2.1" data-path="binomial-models.html"><a href="binomial-models.html#stan"><i class="fa fa-check"></i><b>13.2.1</b> Stan</a></li>
<li class="chapter" data-level="13.2.2" data-path="binomial-models.html"><a href="binomial-models.html#example-vote-turnout"><i class="fa fa-check"></i><b>13.2.2</b> Example: Vote Turnout</a></li>
<li class="chapter" data-level="13.2.3" data-path="binomial-models.html"><a href="binomial-models.html#stan-1"><i class="fa fa-check"></i><b>13.2.3</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="binomial-models.html"><a href="binomial-models.html#references-6"><i class="fa fa-check"></i><b>13.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="separtion.html"><a href="separtion.html"><i class="fa fa-check"></i><b>14</b> Separation</a><ul>
<li class="chapter" data-level="" data-path="separtion.html"><a href="separtion.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="14.1" data-path="separtion.html"><a href="separtion.html#introduction-3"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="separtion.html"><a href="separtion.html#complete-separation"><i class="fa fa-check"></i><b>14.2</b> Complete Separation</a></li>
<li class="chapter" data-level="14.3" data-path="separtion.html"><a href="separtion.html#quasi-separation"><i class="fa fa-check"></i><b>14.3</b> Quasi-Separation</a></li>
<li class="chapter" data-level="14.4" data-path="separtion.html"><a href="separtion.html#weak-priors"><i class="fa fa-check"></i><b>14.4</b> Weak Priors</a></li>
<li class="chapter" data-level="14.5" data-path="separtion.html"><a href="separtion.html#example-support-of-aca-medicaid-expansion"><i class="fa fa-check"></i><b>14.5</b> Example: Support of ACA Medicaid Expansion</a></li>
<li class="chapter" data-level="14.6" data-path="separtion.html"><a href="separtion.html#questions-2"><i class="fa fa-check"></i><b>14.6</b> Questions</a></li>
<li class="chapter" data-level="14.7" data-path="separtion.html"><a href="separtion.html#references-7"><i class="fa fa-check"></i><b>14.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="robust-regression.html"><a href="robust-regression.html"><i class="fa fa-check"></i><b>15</b> Robust Regression</a><ul>
<li class="chapter" data-level="" data-path="robust-regression.html"><a href="robust-regression.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="15.1" data-path="robust-regression.html"><a href="robust-regression.html#wide-tailed-distributions"><i class="fa fa-check"></i><b>15.1</b> Wide Tailed Distributions</a></li>
<li class="chapter" data-level="15.2" data-path="robust-regression.html"><a href="robust-regression.html#student-t-distribution"><i class="fa fa-check"></i><b>15.2</b> Student-t distribution</a><ul>
<li class="chapter" data-level="15.2.1" data-path="robust-regression.html"><a href="robust-regression.html#examples-2"><i class="fa fa-check"></i><b>15.2.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="robust-regression.html"><a href="robust-regression.html#robit"><i class="fa fa-check"></i><b>15.3</b> Robit</a></li>
<li class="chapter" data-level="15.4" data-path="robust-regression.html"><a href="robust-regression.html#quantile-regression"><i class="fa fa-check"></i><b>15.4</b> Quantile regression</a><ul>
<li class="chapter" data-level="15.4.1" data-path="robust-regression.html"><a href="robust-regression.html#questions-3"><i class="fa fa-check"></i><b>15.4.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="robust-regression.html"><a href="robust-regression.html#references-8"><i class="fa fa-check"></i><b>15.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html"><i class="fa fa-check"></i><b>16</b> Heteroskedasticity</a><ul>
<li class="chapter" data-level="" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="16.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#introduction-4"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#weighted-regression"><i class="fa fa-check"></i><b>16.2</b> Weighted Regression</a></li>
<li class="chapter" data-level="16.3" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#modeling-the-scale-with-covariates"><i class="fa fa-check"></i><b>16.3</b> Modeling the Scale with Covariates</a></li>
<li class="chapter" data-level="16.4" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prior-distributions"><i class="fa fa-check"></i><b>16.4</b> Prior Distributions</a><ul>
<li class="chapter" data-level="16.4.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#examples-duncan"><i class="fa fa-check"></i><b>16.4.1</b> Examples: Duncan</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#exercises"><i class="fa fa-check"></i><b>16.5</b> Exercises</a></li>
<li class="chapter" data-level="16.6" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#references-9"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="rare-events.html"><a href="rare-events.html"><i class="fa fa-check"></i><b>17</b> Rare Events</a><ul>
<li class="chapter" data-level="" data-path="rare-events.html"><a href="rare-events.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="17.1" data-path="rare-events.html"><a href="rare-events.html#introduction-5"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="rare-events.html"><a href="rare-events.html#finite-sample-bias"><i class="fa fa-check"></i><b>17.2</b> Finite-Sample Bias</a></li>
<li class="chapter" data-level="17.3" data-path="rare-events.html"><a href="rare-events.html#case-control"><i class="fa fa-check"></i><b>17.3</b> Case Control</a></li>
<li class="chapter" data-level="17.4" data-path="rare-events.html"><a href="rare-events.html#questions-4"><i class="fa fa-check"></i><b>17.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>18</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="18.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-hits"><i class="fa fa-check"></i><b>18.1</b> Example: Baseball Hits</a><ul>
<li class="chapter" data-level="18.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#references-10"><i class="fa fa-check"></i><b>18.1.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>19</b> Multilevel Models</a><ul>
<li class="chapter" data-level="19.1" data-path="multilevel-models.html"><a href="multilevel-models.html#example-radon"><i class="fa fa-check"></i><b>19.1</b> Example: Radon</a><ul>
<li class="chapter" data-level="19.1.1" data-path="multilevel-models.html"><a href="multilevel-models.html#data"><i class="fa fa-check"></i><b>19.1.1</b> Data</a></li>
<li class="chapter" data-level="19.1.2" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-intercepts-models"><i class="fa fa-check"></i><b>19.1.2</b> Varying Intercepts Models</a></li>
<li class="chapter" data-level="19.1.3" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-intercept-model"><i class="fa fa-check"></i><b>19.1.3</b> Varying Intercept Model</a></li>
<li class="chapter" data-level="19.1.4" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-slope-model"><i class="fa fa-check"></i><b>19.1.4</b> Varying Slope Model</a></li>
<li class="chapter" data-level="19.1.5" data-path="multilevel-models.html"><a href="multilevel-models.html#group-level-predictors"><i class="fa fa-check"></i><b>19.1.5</b> Group Level Predictors</a></li>
<li class="chapter" data-level="19.1.6" data-path="multilevel-models.html"><a href="multilevel-models.html#lme4"><i class="fa fa-check"></i><b>19.1.6</b> lme4</a></li>
<li class="chapter" data-level="19.1.7" data-path="multilevel-models.html"><a href="multilevel-models.html#rstanarm-1"><i class="fa fa-check"></i><b>19.1.7</b> rstanarm</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="multilevel-models.html"><a href="multilevel-models.html#pooling-of-hierarchical-parameters"><i class="fa fa-check"></i><b>19.2</b> Pooling of Hierarchical Parameters</a></li>
<li class="chapter" data-level="19.3" data-path="multilevel-models.html"><a href="multilevel-models.html#anova"><i class="fa fa-check"></i><b>19.3</b> ANOVA</a></li>
<li class="chapter" data-level="19.4" data-path="multilevel-models.html"><a href="multilevel-models.html#time-series-cross-section"><i class="fa fa-check"></i><b>19.4</b> Time-Series Cross Section</a></li>
<li class="chapter" data-level="19.5" data-path="multilevel-models.html"><a href="multilevel-models.html#miscellaneous"><i class="fa fa-check"></i><b>19.5</b> Miscellaneous</a><ul>
<li class="chapter" data-level="19.5.1" data-path="multilevel-models.html"><a href="multilevel-models.html#how-many-groups"><i class="fa fa-check"></i><b>19.5.1</b> How many groups?</a></li>
<li class="chapter" data-level="19.5.2" data-path="multilevel-models.html"><a href="multilevel-models.html#correlation-between-predictors-and-errors"><i class="fa fa-check"></i><b>19.5.2</b> Correlation between Predictors and Errors</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="multilevel-models.html"><a href="multilevel-models.html#references-11"><i class="fa fa-check"></i><b>19.6</b> References</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="20" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>20</b> Distributions</a></li>
<li class="chapter" data-level="21" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html"><i class="fa fa-check"></i><b>21</b> Annotated Bibliography</a><ul>
<li class="chapter" data-level="21.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#textbooks"><i class="fa fa-check"></i><b>21.1</b> Textbooks</a></li>
<li class="chapter" data-level="21.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#syllabi"><i class="fa fa-check"></i><b>21.2</b> Syllabi</a></li>
<li class="chapter" data-level="21.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#topics"><i class="fa fa-check"></i><b>21.3</b> Topics</a></li>
<li class="chapter" data-level="21.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-theorem-1"><i class="fa fa-check"></i><b>21.4</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="21.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#article-length-introductions-to-bayesian-statistics"><i class="fa fa-check"></i><b>21.5</b> Article Length Introductions to Bayesian Statistics</a><ul>
<li class="chapter" data-level="21.5.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#why-bayesian"><i class="fa fa-check"></i><b>21.5.1</b> Why Bayesian</a></li>
<li class="chapter" data-level="21.5.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#modern-statistical-workflow"><i class="fa fa-check"></i><b>21.5.2</b> Modern Statistical Workflow</a></li>
<li class="chapter" data-level="21.5.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-philosophy"><i class="fa fa-check"></i><b>21.5.3</b> Bayesian Philosophy</a></li>
<li class="chapter" data-level="21.5.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-hypothesis-testing"><i class="fa fa-check"></i><b>21.5.4</b> Bayesian Hypothesis Testing</a></li>
<li class="chapter" data-level="21.5.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-frequentist-debates"><i class="fa fa-check"></i><b>21.5.5</b> Bayesian Frequentist Debates</a></li>
<li class="chapter" data-level="21.5.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#categorical"><i class="fa fa-check"></i><b>21.5.6</b> Categorical</a></li>
<li class="chapter" data-level="21.5.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#variable-selection"><i class="fa fa-check"></i><b>21.5.7</b> Variable Selection</a></li>
<li class="chapter" data-level="21.5.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multiple-testing"><i class="fa fa-check"></i><b>21.5.8</b> Multiple Testing</a></li>
<li class="chapter" data-level="21.5.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#rare-events-1"><i class="fa fa-check"></i><b>21.5.9</b> Rare Events</a></li>
<li class="chapter" data-level="21.5.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#identifiability"><i class="fa fa-check"></i><b>21.5.10</b> Identifiability</a></li>
<li class="chapter" data-level="21.5.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkage"><i class="fa fa-check"></i><b>21.5.11</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software"><i class="fa fa-check"></i><b>21.6</b> Software</a><ul>
<li class="chapter" data-level="21.6.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-2"><i class="fa fa-check"></i><b>21.6.1</b> Stan</a></li>
<li class="chapter" data-level="21.6.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#diagrams"><i class="fa fa-check"></i><b>21.6.2</b> Diagrams</a></li>
<li class="chapter" data-level="21.6.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#priors-1"><i class="fa fa-check"></i><b>21.6.3</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-model-averaging"><i class="fa fa-check"></i><b>21.7</b> Bayesian Model Averaging</a></li>
<li class="chapter" data-level="21.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multilevel-modeling"><i class="fa fa-check"></i><b>21.8</b> Multilevel Modeling</a></li>
<li class="chapter" data-level="21.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#mixture-models"><i class="fa fa-check"></i><b>21.9</b> Mixture Models</a></li>
<li class="chapter" data-level="21.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#inference"><i class="fa fa-check"></i><b>21.10</b> Inference</a><ul>
<li class="chapter" data-level="21.10.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#discussion-of-bayesian-inference"><i class="fa fa-check"></i><b>21.10.1</b> Discussion of Bayesian Inference</a></li>
</ul></li>
<li class="chapter" data-level="21.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#model-checking-1"><i class="fa fa-check"></i><b>21.11</b> Model Checking</a><ul>
<li class="chapter" data-level="21.11.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>21.11.1</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="21.11.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#prediction-criteria"><i class="fa fa-check"></i><b>21.11.2</b> Prediction Criteria</a></li>
<li class="chapter" data-level="21.11.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software-validation"><i class="fa fa-check"></i><b>21.11.3</b> Software Validation</a></li>
</ul></li>
<li class="chapter" data-level="21.12" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#hierarchical-modeling"><i class="fa fa-check"></i><b>21.12</b> Hierarchical Modeling</a></li>
<li class="chapter" data-level="21.13" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkageregularization"><i class="fa fa-check"></i><b>21.13</b> Shrinkage/Regularization</a></li>
<li class="chapter" data-level="21.14" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#empirical-bayes"><i class="fa fa-check"></i><b>21.14</b> Empirical Bayes</a></li>
<li class="chapter" data-level="21.15" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#history-of-bayesian-statistics"><i class="fa fa-check"></i><b>21.15</b> History of Bayesian Statistics</a></li>
<li class="chapter" data-level="21.16" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#sampling-difficulties"><i class="fa fa-check"></i><b>21.16</b> Sampling Difficulties</a></li>
<li class="chapter" data-level="21.17" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#complicated-estimation-and-testing"><i class="fa fa-check"></i><b>21.17</b> Complicated Estimation and Testing</a></li>
<li class="chapter" data-level="21.18" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#pooling-polls"><i class="fa fa-check"></i><b>21.18</b> Pooling Polls</a></li>
<li class="chapter" data-level="21.19" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#visualizing-mcmc-methods"><i class="fa fa-check"></i><b>21.19</b> Visualizing MCMC Methods</a></li>
<li class="chapter" data-level="21.20" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-point-estimation-decision"><i class="fa fa-check"></i><b>21.20</b> Bayesian point estimation / Decision</a></li>
<li class="chapter" data-level="21.21" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-modeling-language"><i class="fa fa-check"></i><b>21.21</b> Stan Modeling Language</a></li>
<li class="chapter" data-level="21.22" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-factors"><i class="fa fa-check"></i><b>21.22</b> Bayes Factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-12.html"><a href="references-12.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Updating: A Set of Bayesian Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\[
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\mean}{mean}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Cor}{Cor}
\DeclareMathOperator{\Bias}{Bias}
\DeclareMathOperator{\MSE}{MSE}
\DeclareMathOperator{\RMSE}{RMSE}
\DeclareMathOperator{\sd}{sd}
\DeclareMathOperator{\se}{se}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\median}{median}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\logistic}{Logistic}
\DeclareMathOperator{\logit}{Logit}

\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\vec}[1]{\boldsymbol{#1}}
\newcommand{\T}{'}

% This follows BDA
\newcommand{\dunif}{\mathrm{U}}
\newcommand{\dnorm}{\mathrm{N}}
\newcommand{\dlnorm}{\mathrm{lognormal}}
\newcommand{\dmvnorm}{\mathrm{N}}
\newcommand{\dgamma}{\mathrm{Gamma}}
\newcommand{\dinvgamma}{\mathrm{Inv-Gamma}}
\newcommand{\dchisq}[1]{\chi^2_{#1}}
\newcommand{\dinvchisq}[1]{\mathrm{Inv-}\chi^2_{#1}}
\newcommand{\dexp}{\mathrm{Expon}}
\newcommand{\dlaplace}{\mathrm{Laplace}}
\newcommand{\dweibull}{\mathrm{Weibull}}
\newcommand{\dwishart}[1]{\mathrm{Wishart}_{#1}}
\newcommand{\dinvwishart}[1]{\mathrm{Inv-Wishart}_{#1}}
\newcommand{\dlkj}{\mathrm{LkjCorr}}
\newcommand{\dt}{\mathrm{Student-t}}
\newcommand{\dbeta}{\mathrm{Beta}}
\newcommand{\ddirichlet}{\mathrm{Dirichlet}}
\newcommand{\dlogistic}{\mathrm{Logistic}}
\newcommand{\dllogistic}{\mathrm{Log-logistic}}
\newcommand{\dpois}{\mathrm{Poisson}}
\newcommand{\dBinom}{\mathrm{Bin}}
\newcommand{\dBinom}{\mathrm{Bin}}
\newcommand{\dmultinom}{\mathrm{Multinom}}
\newcommand{\dnbinom}{\mathrm{Neg-bin}}
\newcommand{\dnbinomalt}{\mathrm{Neg-bin2}}
\newcommand{\dbetabinom}{\mathrm{Beta-bin}}
\newcommand{\dcauchy}{\mathrm{Cauchy}}
\newcommand{\dhalfcauchy}{\mathrm{Cauchy}^{+}}
\newcommand{\dlkjcorr}{\mathrm{LKJ}^{+}}
\newcommand{\dbernoulli}{\mathrm{Bernoulli}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Reals}{\R}
\newcommand{\RealPos}{\R^{+}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Nats}{\N}

\newcommand{\cia}{\perp\!\!\!\perp}
\DeclareMathOperator*{\plim}{plim}

\DeclareMathOperator{\invlogit}{Inv-Logit}
\DeclareMathOperator{\logit}{Logit}

\]
<div id="separtion" class="section level1">
<h1><span class="header-section-number">14</span> Separation</h1>
<div id="prerequisites-7" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;rstan&quot;</span>)</a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;rstanarm&quot;</span>)</a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&quot;recipes&quot;</span>)</a>
<a class="sourceLine" id="cb89-5" data-line-number="5"><span class="kw">library</span>(<span class="st">&quot;jrnold.bayes.notes&quot;</span>)</a></code></pre></div>
</div>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">14.1</span> Introduction</h2>
<p>Separation is when a predictor perfectly predicts a binary response variable <span class="citation">(Rainey 2016, <span class="citation">@Zorn2005a</span>)</span>.</p>
<p>For classification problems, there are three cases.</p>
<ul>
<li><em>complete separation</em>: the predictor perfectly predicts both 0’s and 1’s.</li>
<li><em>quasi-complete separation</em>: the predictor perfectly predicts either 0’s or 1’s.</li>
<li><em>overlap</em>: the predictor does not perfectly predict either 0’s or 1’s.</li>
</ul>
<p>Both <strong>complete separation</strong> and <strong>quasi-complete</strong> separation cause problems for binomial maximum likelihood estimators.</p>
</div>
<div id="complete-separation" class="section level2">
<h2><span class="header-section-number">14.2</span> Complete Separation</h2>
<p>The following data is an example of data with complete separation.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">CompleteSeparation</a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="co">#&gt; # A tibble: 8 x 3</span></a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="co">#&gt;       y    x1    x2</span></a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb90-5" data-line-number="5"><span class="co">#&gt; 1     0     1     3</span></a>
<a class="sourceLine" id="cb90-6" data-line-number="6"><span class="co">#&gt; 2     0     2     2</span></a>
<a class="sourceLine" id="cb90-7" data-line-number="7"><span class="co">#&gt; 3     0     3    -1</span></a>
<a class="sourceLine" id="cb90-8" data-line-number="8"><span class="co">#&gt; 4     0     3    -1</span></a>
<a class="sourceLine" id="cb90-9" data-line-number="9"><span class="co">#&gt; 5     1     5     2</span></a>
<a class="sourceLine" id="cb90-10" data-line-number="10"><span class="co">#&gt; 6     1     6     4</span></a>
<a class="sourceLine" id="cb90-11" data-line-number="11"><span class="co">#&gt; # ... with 2 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw">count</span>(CompleteSeparation, y, x1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(x1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(y, p, <span class="dt">fill =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb91-6" data-line-number="6"><span class="co">#&gt; # A tibble: 7 x 3</span></a>
<a class="sourceLine" id="cb91-7" data-line-number="7"><span class="co">#&gt; # Groups:   x1 [7]</span></a>
<a class="sourceLine" id="cb91-8" data-line-number="8"><span class="co">#&gt;      x1   `0`   `1`</span></a>
<a class="sourceLine" id="cb91-9" data-line-number="9"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb91-10" data-line-number="10"><span class="co">#&gt; 1     1     1     0</span></a>
<a class="sourceLine" id="cb91-11" data-line-number="11"><span class="co">#&gt; 2     2     1     0</span></a>
<a class="sourceLine" id="cb91-12" data-line-number="12"><span class="co">#&gt; 3     3     1     0</span></a>
<a class="sourceLine" id="cb91-13" data-line-number="13"><span class="co">#&gt; 4     5     0     1</span></a>
<a class="sourceLine" id="cb91-14" data-line-number="14"><span class="co">#&gt; 5     6     0     1</span></a>
<a class="sourceLine" id="cb91-15" data-line-number="15"><span class="co">#&gt; 6    10     0     1</span></a>
<a class="sourceLine" id="cb91-16" data-line-number="16"><span class="co">#&gt; # ... with 1 more row</span></a></code></pre></div>
<p>The variable <code>x1</code> perfectly separates <code>y</code>, since when <code>x1 &lt;= 3</code>, <code>y = 0</code>,
and when <code>x1 &gt; 3</code>, <code>y = 1</code>.</p>
<p>The MLE of the binomial likelihood with a logistic link function for this data has a finite log-likelihood, but the optimal line is a step function. This pushes the coefficient for the separating variable to <span class="math inline">\(\infty\)</span>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="kw">ggplot</span>(CompleteSeparation, <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb92-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x, <span class="dt">se =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb92-4" data-line-number="4">              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="kw">binomial</span>()), <span class="dt">colour =</span> <span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb92-5" data-line-number="5"><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></a></code></pre></div>
<p><img src="separation_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>If we estimate a binomial model with this data, it will warn that some observations have predicted probabilities close to zero or one.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">fit_cs1 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data =</span> CompleteSeparation, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3"><span class="kw">summary</span>(fit_cs1)</a>
<a class="sourceLine" id="cb93-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="co">#&gt; glm(formula = y ~ x1 + x2, family = binomial(), data = CompleteSeparation)</span></a>
<a class="sourceLine" id="cb93-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb93-8" data-line-number="8"><span class="co">#&gt; Deviance Residuals: </span></a>
<a class="sourceLine" id="cb93-9" data-line-number="9"><span class="co">#&gt;         1          2          3          4          5          6  </span></a>
<a class="sourceLine" id="cb93-10" data-line-number="10"><span class="co">#&gt; -2.10e-08  -1.40e-05  -2.52e-06  -2.52e-06   1.56e-05   2.10e-08  </span></a>
<a class="sourceLine" id="cb93-11" data-line-number="11"><span class="co">#&gt;         7          8  </span></a>
<a class="sourceLine" id="cb93-12" data-line-number="12"><span class="co">#&gt;  2.10e-08   2.10e-08  </span></a>
<a class="sourceLine" id="cb93-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb93-14" data-line-number="14"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb93-15" data-line-number="15"><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)</span></a>
<a class="sourceLine" id="cb93-16" data-line-number="16"><span class="co">#&gt; (Intercept)    -66.10  183471.72       0        1</span></a>
<a class="sourceLine" id="cb93-17" data-line-number="17"><span class="co">#&gt; x1              15.29   27362.84       0        1</span></a>
<a class="sourceLine" id="cb93-18" data-line-number="18"><span class="co">#&gt; x2               6.24   81543.72       0        1</span></a>
<a class="sourceLine" id="cb93-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb93-20" data-line-number="20"><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></a>
<a class="sourceLine" id="cb93-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb93-22" data-line-number="22"><span class="co">#&gt;     Null deviance: 1.1090e+01  on 7  degrees of freedom</span></a>
<a class="sourceLine" id="cb93-23" data-line-number="23"><span class="co">#&gt; Residual deviance: 4.5454e-10  on 5  degrees of freedom</span></a>
<a class="sourceLine" id="cb93-24" data-line-number="24"><span class="co">#&gt; AIC: 6</span></a>
<a class="sourceLine" id="cb93-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb93-26" data-line-number="26"><span class="co">#&gt; Number of Fisher Scoring iterations: 24</span></a></code></pre></div>
<p>Additionally, the standard errors are implausibly large.</p>
</div>
<div id="quasi-separation" class="section level2">
<h2><span class="header-section-number">14.3</span> Quasi-Separation</h2>
<p>The following generated data is an example of quasi-separation.[^quasi-separation]</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(QuasiSeparation)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="right">x1</th>
<th align="right">x2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">3</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">6</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">10</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">11</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>The variable <code>x1</code> <em>almost</em> separates <code>y</code>.
When <code>x1 &lt; 3</code>, <code>y = 0</code>, and when <code>x1 &gt; 3</code>, <code>y = 1</code>.
Only when <code>x1 = 3</code>, does <code>y</code> takes values of both 0 and 1.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="kw">count</span>(QuasiSeparation, y, x1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(x1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(y, p, <span class="dt">fill =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb95-6" data-line-number="6"><span class="co">#&gt; # A tibble: 8 x 3</span></a>
<a class="sourceLine" id="cb95-7" data-line-number="7"><span class="co">#&gt; # Groups:   x1 [8]</span></a>
<a class="sourceLine" id="cb95-8" data-line-number="8"><span class="co">#&gt;      x1   `0`   `1`</span></a>
<a class="sourceLine" id="cb95-9" data-line-number="9"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb95-10" data-line-number="10"><span class="co">#&gt; 1     1 1     0    </span></a>
<a class="sourceLine" id="cb95-11" data-line-number="11"><span class="co">#&gt; 2     2 1     0    </span></a>
<a class="sourceLine" id="cb95-12" data-line-number="12"><span class="co">#&gt; 3     3 0.667 0.333</span></a>
<a class="sourceLine" id="cb95-13" data-line-number="13"><span class="co">#&gt; 4     4 0     1    </span></a>
<a class="sourceLine" id="cb95-14" data-line-number="14"><span class="co">#&gt; 5     5 0     1    </span></a>
<a class="sourceLine" id="cb95-15" data-line-number="15"><span class="co">#&gt; 6     6 0     1    </span></a>
<a class="sourceLine" id="cb95-16" data-line-number="16"><span class="co">#&gt; # ... with 2 more rows</span></a></code></pre></div>
<p>In the quasi-separation case, like the complete separation case, the best line is something close to a step function.
Unlike the <strong>complete separation</strong> case, the coefficient for the separating variable takes a finite, but very large value.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">ggplot</span>(QuasiSeparation, <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x, <span class="dt">se =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb96-4" data-line-number="4">              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="kw">binomial</span>()), <span class="dt">colour =</span> <span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb96-5" data-line-number="5"><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></a></code></pre></div>
<p><img src="separation_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">fit_qs1 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data =</span> QuasiSeparation, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="kw">summary</span>(fit_qs1)</a>
<a class="sourceLine" id="cb97-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-5" data-line-number="5"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb97-6" data-line-number="6"><span class="co">#&gt; glm(formula = y ~ x1 + x2, family = binomial(), data = QuasiSeparation)</span></a>
<a class="sourceLine" id="cb97-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-8" data-line-number="8"><span class="co">#&gt; Deviance Residuals: </span></a>
<a class="sourceLine" id="cb97-9" data-line-number="9"><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></a>
<a class="sourceLine" id="cb97-10" data-line-number="10"><span class="co">#&gt; -1.0042  -0.0001   0.0000   0.0000   1.4689  </span></a>
<a class="sourceLine" id="cb97-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-12" data-line-number="12"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb97-13" data-line-number="13"><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)</span></a>
<a class="sourceLine" id="cb97-14" data-line-number="14"><span class="co">#&gt; (Intercept)   -58.076  17511.903     0.0     1.00</span></a>
<a class="sourceLine" id="cb97-15" data-line-number="15"><span class="co">#&gt; x1             19.178   5837.301     0.0     1.00</span></a>
<a class="sourceLine" id="cb97-16" data-line-number="16"><span class="co">#&gt; x2             -0.121      0.610    -0.2     0.84</span></a>
<a class="sourceLine" id="cb97-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-18" data-line-number="18"><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></a>
<a class="sourceLine" id="cb97-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-20" data-line-number="20"><span class="co">#&gt;     Null deviance: 13.4602  on 9  degrees of freedom</span></a>
<a class="sourceLine" id="cb97-21" data-line-number="21"><span class="co">#&gt; Residual deviance:  3.7792  on 7  degrees of freedom</span></a>
<a class="sourceLine" id="cb97-22" data-line-number="22"><span class="co">#&gt; AIC: 9.779</span></a>
<a class="sourceLine" id="cb97-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-24" data-line-number="24"><span class="co">#&gt; Number of Fisher Scoring iterations: 21</span></a></code></pre></div>
</div>
<div id="weak-priors" class="section level2">
<h2><span class="header-section-number">14.4</span> Weak Priors</h2>
<p>While the likelihood is unidentified, weakly informative priors on the regression coefficients will deal with separation.
<span class="math display">\[
\beta_k \sim \dnorm(0, 2.5)
\]</span>
where all the columns of <span class="math inline">\(\code{x}\)</span> are assumed to have unit variance (or be otherwise standardized).
The half-Cauchy prior, <span class="math inline">\(\dhalfcauchy(0, 2.5)\)</span>, suggested in <span class="citation">Gelman et al. (2008)</span> is insufficiently informative to to deal with separation <span class="citation">(Ghosh, Li, and Mitra 2015)</span>, but finite-variance weakly informative Student-t or Normal distributions will work.</p>
<p>These are the priors suggested by <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">Stan</a> and
used by default in <strong>rstanarm</strong> <a href="https://www.rdocumentation.org/packages/rstanarm/topics/stan_glm">rstanarm</a>.</p>
<p>When estimated with <code>stan_glm()</code>, the coefficients of both the complete separation and quasi-separated data are finite.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">fit_cs2 &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data =</span> CompleteSeparation,</a>
<a class="sourceLine" id="cb98-2" data-line-number="2">                    <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="kw">summary</span>(fit_cs2)</a>
<a class="sourceLine" id="cb98-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-5" data-line-number="5"><span class="co">#&gt; Model Info:</span></a>
<a class="sourceLine" id="cb98-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-7" data-line-number="7"><span class="co">#&gt;  function:     stan_glm</span></a>
<a class="sourceLine" id="cb98-8" data-line-number="8"><span class="co">#&gt;  family:       binomial [logit]</span></a>
<a class="sourceLine" id="cb98-9" data-line-number="9"><span class="co">#&gt;  formula:      y ~ x1 + x2</span></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="co">#&gt;  algorithm:    sampling</span></a>
<a class="sourceLine" id="cb98-11" data-line-number="11"><span class="co">#&gt;  priors:       see help(&#39;prior_summary&#39;)</span></a>
<a class="sourceLine" id="cb98-12" data-line-number="12"><span class="co">#&gt;  sample:       4000 (posterior sample size)</span></a>
<a class="sourceLine" id="cb98-13" data-line-number="13"><span class="co">#&gt;  observations: 8</span></a>
<a class="sourceLine" id="cb98-14" data-line-number="14"><span class="co">#&gt;  predictors:   3</span></a>
<a class="sourceLine" id="cb98-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-16" data-line-number="16"><span class="co">#&gt; Estimates:</span></a>
<a class="sourceLine" id="cb98-17" data-line-number="17"><span class="co">#&gt;                 mean   sd    2.5%   25%   50%   75%   97.5%</span></a>
<a class="sourceLine" id="cb98-18" data-line-number="18"><span class="co">#&gt; (Intercept)    -6.2    2.7 -12.1   -7.8  -5.9  -4.3  -1.6  </span></a>
<a class="sourceLine" id="cb98-19" data-line-number="19"><span class="co">#&gt; x1              1.1    0.4   0.3    0.8   1.0   1.3   2.1  </span></a>
<a class="sourceLine" id="cb98-20" data-line-number="20"><span class="co">#&gt; x2              0.9    0.8  -0.5    0.3   0.8   1.3   2.5  </span></a>
<a class="sourceLine" id="cb98-21" data-line-number="21"><span class="co">#&gt; mean_PPD        0.5    0.1   0.2    0.4   0.5   0.6   0.8  </span></a>
<a class="sourceLine" id="cb98-22" data-line-number="22"><span class="co">#&gt; log-posterior  -8.4    1.4 -11.8   -9.1  -8.1  -7.4  -6.9  </span></a>
<a class="sourceLine" id="cb98-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-24" data-line-number="24"><span class="co">#&gt; Diagnostics:</span></a>
<a class="sourceLine" id="cb98-25" data-line-number="25"><span class="co">#&gt;               mcse Rhat n_eff</span></a>
<a class="sourceLine" id="cb98-26" data-line-number="26"><span class="co">#&gt; (Intercept)   0.1  1.0  2090 </span></a>
<a class="sourceLine" id="cb98-27" data-line-number="27"><span class="co">#&gt; x1            0.0  1.0  2114 </span></a>
<a class="sourceLine" id="cb98-28" data-line-number="28"><span class="co">#&gt; x2            0.0  1.0  2412 </span></a>
<a class="sourceLine" id="cb98-29" data-line-number="29"><span class="co">#&gt; mean_PPD      0.0  1.0  3796 </span></a>
<a class="sourceLine" id="cb98-30" data-line-number="30"><span class="co">#&gt; log-posterior 0.0  1.0  1641 </span></a>
<a class="sourceLine" id="cb98-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-32" data-line-number="32"><span class="co">#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span></a></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">fit_qs2 &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data =</span> QuasiSeparation, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="kw">summary</span>(fit_qs2)</a>
<a class="sourceLine" id="cb99-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb99-4" data-line-number="4"><span class="co">#&gt; Model Info:</span></a>
<a class="sourceLine" id="cb99-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb99-6" data-line-number="6"><span class="co">#&gt;  function:     stan_glm</span></a>
<a class="sourceLine" id="cb99-7" data-line-number="7"><span class="co">#&gt;  family:       binomial [logit]</span></a>
<a class="sourceLine" id="cb99-8" data-line-number="8"><span class="co">#&gt;  formula:      y ~ x1 + x2</span></a>
<a class="sourceLine" id="cb99-9" data-line-number="9"><span class="co">#&gt;  algorithm:    sampling</span></a>
<a class="sourceLine" id="cb99-10" data-line-number="10"><span class="co">#&gt;  priors:       see help(&#39;prior_summary&#39;)</span></a>
<a class="sourceLine" id="cb99-11" data-line-number="11"><span class="co">#&gt;  sample:       4000 (posterior sample size)</span></a>
<a class="sourceLine" id="cb99-12" data-line-number="12"><span class="co">#&gt;  observations: 10</span></a>
<a class="sourceLine" id="cb99-13" data-line-number="13"><span class="co">#&gt;  predictors:   3</span></a>
<a class="sourceLine" id="cb99-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb99-15" data-line-number="15"><span class="co">#&gt; Estimates:</span></a>
<a class="sourceLine" id="cb99-16" data-line-number="16"><span class="co">#&gt;                 mean   sd    2.5%   25%   50%   75%   97.5%</span></a>
<a class="sourceLine" id="cb99-17" data-line-number="17"><span class="co">#&gt; (Intercept)    -3.7    1.9  -7.6   -4.9  -3.6  -2.3  -0.2  </span></a>
<a class="sourceLine" id="cb99-18" data-line-number="18"><span class="co">#&gt; x1              1.1    0.5   0.2    0.7   1.1   1.4   2.2  </span></a>
<a class="sourceLine" id="cb99-19" data-line-number="19"><span class="co">#&gt; x2              0.0    0.4  -0.7   -0.2   0.0   0.3   0.9  </span></a>
<a class="sourceLine" id="cb99-20" data-line-number="20"><span class="co">#&gt; mean_PPD        0.6    0.2   0.3    0.5   0.6   0.7   0.9  </span></a>
<a class="sourceLine" id="cb99-21" data-line-number="21"><span class="co">#&gt; log-posterior -10.5    1.3 -13.8  -11.1 -10.2  -9.5  -9.0  </span></a>
<a class="sourceLine" id="cb99-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb99-23" data-line-number="23"><span class="co">#&gt; Diagnostics:</span></a>
<a class="sourceLine" id="cb99-24" data-line-number="24"><span class="co">#&gt;               mcse Rhat n_eff</span></a>
<a class="sourceLine" id="cb99-25" data-line-number="25"><span class="co">#&gt; (Intercept)   0.0  1.0  2746 </span></a>
<a class="sourceLine" id="cb99-26" data-line-number="26"><span class="co">#&gt; x1            0.0  1.0  1596 </span></a>
<a class="sourceLine" id="cb99-27" data-line-number="27"><span class="co">#&gt; x2            0.0  1.0  2469 </span></a>
<a class="sourceLine" id="cb99-28" data-line-number="28"><span class="co">#&gt; mean_PPD      0.0  1.0  3688 </span></a>
<a class="sourceLine" id="cb99-29" data-line-number="29"><span class="co">#&gt; log-posterior 0.0  1.0  1509 </span></a>
<a class="sourceLine" id="cb99-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb99-31" data-line-number="31"><span class="co">#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span></a></code></pre></div>
</div>
<div id="example-support-of-aca-medicaid-expansion" class="section level2">
<h2><span class="header-section-number">14.5</span> Example: Support of ACA Medicaid Expansion</h2>
<p>This example is from <span class="citation">Rainey (2016)</span> from the original paper <span class="citation">Barrilleaux and Rainey (2014)</span>
with replication code <a href="https://github.com/carlislerainey/separation">here</a>.
Load the data included in the <strong>jrnold.bayes.notes</strong> package:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;politics_and_need&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;jrnold.bayes.notes&quot;</span>)</a></code></pre></div>
<p>The observations are the governors of the US states.
The outcome variable is their votes on the Affordable Care Act (ACA) Medicaid Expansion.
The dataset includes multiple predictors, including whether the governor is a Republican (<code>gop_governor</code>).
Add Democratic governors supported the expansion (<code>gop_governor == 0</code>),
and only Republican governors (<code>gop_governor == 1</code>) opposed it (though not all).</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="co"># count(politics_and_need, gop_governor, oppose_expansion)</span></a></code></pre></div>
<p>This is a case of quasi-separation.</p>
<p>What happens when this model is estimated with MLE by <code>glm()</code>?</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">aca_fmla &lt;-</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="st">  </span>oppose_expansion <span class="op">~</span><span class="st"> </span>gop_governor <span class="op">+</span><span class="st"> </span>percent_favorable_aca <span class="op">+</span><span class="st"> </span>gop_leg <span class="op">+</span></a>
<a class="sourceLine" id="cb102-3" data-line-number="3"><span class="st">         </span>percent_uninsured <span class="op">+</span><span class="st"> </span>bal2012 <span class="op">+</span><span class="st"> </span>multiplier <span class="op">+</span><span class="st"> </span>percent_nonwhite <span class="op">+</span></a>
<a class="sourceLine" id="cb102-4" data-line-number="4"><span class="st">         </span>percent_metro</a>
<a class="sourceLine" id="cb102-5" data-line-number="5">fit_aca1 &lt;-<span class="st"> </span><span class="kw">glm</span>(aca_fmla, <span class="dt">data =</span> politics_and_need, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb102-6" data-line-number="6"><span class="kw">summary</span>(fit_aca1)</a>
<a class="sourceLine" id="cb102-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb102-8" data-line-number="8"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb102-9" data-line-number="9"><span class="co">#&gt; glm(formula = aca_fmla, family = binomial(), data = politics_and_need)</span></a>
<a class="sourceLine" id="cb102-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb102-11" data-line-number="11"><span class="co">#&gt; Deviance Residuals: </span></a>
<a class="sourceLine" id="cb102-12" data-line-number="12"><span class="co">#&gt;    Min      1Q  Median      3Q     Max  </span></a>
<a class="sourceLine" id="cb102-13" data-line-number="13"><span class="co">#&gt; -1.738  -0.455   0.000   0.591   2.350  </span></a>
<a class="sourceLine" id="cb102-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb102-15" data-line-number="15"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb102-16" data-line-number="16"><span class="co">#&gt;                        Estimate Std. Error z value Pr(&gt;|z|)</span></a>
<a class="sourceLine" id="cb102-17" data-line-number="17"><span class="co">#&gt; (Intercept)           -1.94e+01   3.22e+03   -0.01     1.00</span></a>
<a class="sourceLine" id="cb102-18" data-line-number="18"><span class="co">#&gt; gop_governor           2.03e+01   3.22e+03    0.01     0.99</span></a>
<a class="sourceLine" id="cb102-19" data-line-number="19"><span class="co">#&gt; percent_favorable_aca  7.31e-03   8.88e-02    0.08     0.93</span></a>
<a class="sourceLine" id="cb102-20" data-line-number="20"><span class="co">#&gt; gop_leg                2.43e+00   1.48e+00    1.64     0.10</span></a>
<a class="sourceLine" id="cb102-21" data-line-number="21"><span class="co">#&gt; percent_uninsured      1.12e-01   2.72e-01    0.41     0.68</span></a>
<a class="sourceLine" id="cb102-22" data-line-number="22"><span class="co">#&gt; bal2012               -7.12e-04   1.14e-02   -0.06     0.95</span></a>
<a class="sourceLine" id="cb102-23" data-line-number="23"><span class="co">#&gt; multiplier            -3.22e-01   1.08e+00   -0.30     0.77</span></a>
<a class="sourceLine" id="cb102-24" data-line-number="24"><span class="co">#&gt; percent_nonwhite       4.52e-02   8.25e-02    0.55     0.58</span></a>
<a class="sourceLine" id="cb102-25" data-line-number="25"><span class="co">#&gt; percent_metro         -7.75e-02   4.74e-02   -1.64     0.10</span></a>
<a class="sourceLine" id="cb102-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb102-27" data-line-number="27"><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></a>
<a class="sourceLine" id="cb102-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb102-29" data-line-number="29"><span class="co">#&gt;     Null deviance: 62.687  on 49  degrees of freedom</span></a>
<a class="sourceLine" id="cb102-30" data-line-number="30"><span class="co">#&gt; Residual deviance: 31.710  on 41  degrees of freedom</span></a>
<a class="sourceLine" id="cb102-31" data-line-number="31"><span class="co">#&gt; AIC: 49.71</span></a>
<a class="sourceLine" id="cb102-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb102-33" data-line-number="33"><span class="co">#&gt; Number of Fisher Scoring iterations: 19</span></a></code></pre></div>
<p>Now estimate with <strong>rstanarm</strong> using the default weakly informative priors.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1">fit_aca2 &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(aca_fmla, <span class="dt">data =</span> politics_and_need,</a>
<a class="sourceLine" id="cb103-2" data-line-number="2">                     <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb103-3" data-line-number="3">                     <span class="dt">show_messages =</span> <span class="ot">FALSE</span>, <span class="dt">refresh =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb103-4" data-line-number="4">                     <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">summary</span>(fit_aca2)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="co">#&gt; Model Info:</span></a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb104-5" data-line-number="5"><span class="co">#&gt;  function:     stan_glm</span></a>
<a class="sourceLine" id="cb104-6" data-line-number="6"><span class="co">#&gt;  family:       binomial [logit]</span></a>
<a class="sourceLine" id="cb104-7" data-line-number="7"><span class="co">#&gt;  formula:      oppose_expansion ~ gop_governor + percent_favorable_aca + gop_leg + </span></a>
<a class="sourceLine" id="cb104-8" data-line-number="8"><span class="co">#&gt;     percent_uninsured + bal2012 + multiplier + percent_nonwhite + </span></a>
<a class="sourceLine" id="cb104-9" data-line-number="9"><span class="co">#&gt;     percent_metro</span></a>
<a class="sourceLine" id="cb104-10" data-line-number="10"><span class="co">#&gt;  algorithm:    sampling</span></a>
<a class="sourceLine" id="cb104-11" data-line-number="11"><span class="co">#&gt;  priors:       see help(&#39;prior_summary&#39;)</span></a>
<a class="sourceLine" id="cb104-12" data-line-number="12"><span class="co">#&gt;  sample:       4000 (posterior sample size)</span></a>
<a class="sourceLine" id="cb104-13" data-line-number="13"><span class="co">#&gt;  observations: 50</span></a>
<a class="sourceLine" id="cb104-14" data-line-number="14"><span class="co">#&gt;  predictors:   9</span></a>
<a class="sourceLine" id="cb104-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb104-16" data-line-number="16"><span class="co">#&gt; Estimates:</span></a>
<a class="sourceLine" id="cb104-17" data-line-number="17"><span class="co">#&gt;                         mean   sd    2.5%   25%   50%   75%   97.5%</span></a>
<a class="sourceLine" id="cb104-18" data-line-number="18"><span class="co">#&gt; (Intercept)            -3.6    5.1 -13.6   -6.9  -3.6  -0.2   6.5  </span></a>
<a class="sourceLine" id="cb104-19" data-line-number="19"><span class="co">#&gt; gop_governor            3.9    1.6   1.2    2.8   3.8   4.9   7.2  </span></a>
<a class="sourceLine" id="cb104-20" data-line-number="20"><span class="co">#&gt; percent_favorable_aca   0.0    0.1  -0.2   -0.1   0.0   0.0   0.1  </span></a>
<a class="sourceLine" id="cb104-21" data-line-number="21"><span class="co">#&gt; gop_leg                 2.4    1.3   0.0    1.5   2.3   3.2   5.1  </span></a>
<a class="sourceLine" id="cb104-22" data-line-number="22"><span class="co">#&gt; percent_uninsured       0.1    0.2  -0.2    0.0   0.1   0.2   0.5  </span></a>
<a class="sourceLine" id="cb104-23" data-line-number="23"><span class="co">#&gt; bal2012                 0.0    0.0   0.0    0.0   0.0   0.0   0.0  </span></a>
<a class="sourceLine" id="cb104-24" data-line-number="24"><span class="co">#&gt; multiplier             -0.3    1.0  -2.3   -0.9  -0.3   0.4   1.8  </span></a>
<a class="sourceLine" id="cb104-25" data-line-number="25"><span class="co">#&gt; percent_nonwhite        0.0    0.1  -0.1    0.0   0.0   0.1   0.1  </span></a>
<a class="sourceLine" id="cb104-26" data-line-number="26"><span class="co">#&gt; percent_metro          -0.1    0.0  -0.1   -0.1  -0.1   0.0   0.0  </span></a>
<a class="sourceLine" id="cb104-27" data-line-number="27"><span class="co">#&gt; mean_PPD                0.3    0.1   0.2    0.3   0.3   0.4   0.4  </span></a>
<a class="sourceLine" id="cb104-28" data-line-number="28"><span class="co">#&gt; log-posterior         -33.3    2.4 -38.9  -34.6 -32.9 -31.6 -29.8  </span></a>
<a class="sourceLine" id="cb104-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb104-30" data-line-number="30"><span class="co">#&gt; Diagnostics:</span></a>
<a class="sourceLine" id="cb104-31" data-line-number="31"><span class="co">#&gt;                       mcse Rhat n_eff</span></a>
<a class="sourceLine" id="cb104-32" data-line-number="32"><span class="co">#&gt; (Intercept)           0.1  1.0  2754 </span></a>
<a class="sourceLine" id="cb104-33" data-line-number="33"><span class="co">#&gt; gop_governor          0.0  1.0  2598 </span></a>
<a class="sourceLine" id="cb104-34" data-line-number="34"><span class="co">#&gt; percent_favorable_aca 0.0  1.0  3106 </span></a>
<a class="sourceLine" id="cb104-35" data-line-number="35"><span class="co">#&gt; gop_leg               0.0  1.0  3302 </span></a>
<a class="sourceLine" id="cb104-36" data-line-number="36"><span class="co">#&gt; percent_uninsured     0.0  1.0  2520 </span></a>
<a class="sourceLine" id="cb104-37" data-line-number="37"><span class="co">#&gt; bal2012               0.0  1.0  2774 </span></a>
<a class="sourceLine" id="cb104-38" data-line-number="38"><span class="co">#&gt; multiplier            0.0  1.0  3142 </span></a>
<a class="sourceLine" id="cb104-39" data-line-number="39"><span class="co">#&gt; percent_nonwhite      0.0  1.0  2253 </span></a>
<a class="sourceLine" id="cb104-40" data-line-number="40"><span class="co">#&gt; percent_metro         0.0  1.0  3371 </span></a>
<a class="sourceLine" id="cb104-41" data-line-number="41"><span class="co">#&gt; mean_PPD              0.0  1.0  4000 </span></a>
<a class="sourceLine" id="cb104-42" data-line-number="42"><span class="co">#&gt; log-posterior         0.1  1.0  1385 </span></a>
<a class="sourceLine" id="cb104-43" data-line-number="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb104-44" data-line-number="44"><span class="co">#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span></a></code></pre></div>
</div>
<div id="questions-2" class="section level2">
<h2><span class="header-section-number">14.6</span> Questions</h2>
<ul>
<li><p>Estimate the model using <code>stan_glm()</code> with a flat prior, and a Student-t
distribution with <code>df = 3</code>. Compare the coefficient estimates and the
efficiency (<span class="math inline">\(\hat{R}\)</span>, ESS).</p></li>
<li><p><span class="citation">Ghosh, Li, and Mitra (2015)</span> suggest that a Half-Cauchy prior distribution is
insufficient for dealing with separation. Try estimating this model with
a Cauchy prior with a scale of 2.5. Compare the coefficient estimates
and efficiency (<span class="math inline">\(\hat{R}\)</span>, ESS).</p></li>
<li><p>See the other application in <span class="citation">Rainey (2016)</span> on nuclear proliferation and
war. Replicate the analysis with the informative, skeptical, and
enthusiastic priors. The data can be found at <a href="https://github.com/carlislerainey/priors-for-separation/tree/master/bm-replication">carlislerainey/priors-for-separation</a>.</p></li>
</ul>
</div>
<div id="references-7" class="section level2">
<h2><span class="header-section-number">14.7</span> References</h2>
<p>See <span class="citation">Albert and Anderson (1984)</span>, <span class="citation">Heinze and Schemper (2002)</span>, and <span class="citation">Heinze (2006)</span> for discussion
about separation.</p>
<p><span class="citation">Rainey (2016)</span> provides a mixed MLE/Bayesian simulation based approach to apply a prior to the variable with separation, while keeping the other coefficients at their MLE values.
Since the results are highly sensitive to the prior, multiple priors should be tried (informative, skeptical, and enthusiastic).</p>
<p><span class="citation">Firth (1993)</span> suggests a data-driven Jeffreys invariant prior. This prior was also recommended in <span class="citation">Zorn (2005)</span>.</p>
<p><span class="citation">Greenland and Mansournia (2015)</span> suggest a log-F prior distribution which has an intuitive interpretation related to the number of observations.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p><a href="https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faqwhat-is-complete-or-quasi-complete-separation-in-logisticprobit-regression-and-how-do-we-deal-with-them/">FAQ: What is Complete or Quasi-Complete Separation in Logistic/Probit Regression and How do We Deal With Them?</a><a href="separtion.html#fnref10" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="binomial-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="robust-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrnold/bayesian_notes/edit/master/separation.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
